<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Rules that flag suboptimal code.">
<meta name="keywords" content=" Performance, AvoidDebugStatements, AvoidNonRestrictiveQueries, EagerlyLoadedDescribeSObjectResult, OperationWithHighCostInLoop, OperationWithLimitsInLoop">
<title>Performance | PMD Source Code Analyzer</title>


<link rel="stylesheet" type="text/css" href="assets/fontawesome-free-5.15.4-web/css/all.min.css">
<link rel="stylesheet" type="text/css" href="assets/bootstrap-4.5.2-dist/css/bootstrap.min.css">

<link rel="stylesheet" type="text/css" href="css/syntax.css">
<link rel="stylesheet" type="text/css" href="css/modern-business.css">
<link rel="stylesheet" type="text/css" href="css/customstyles.css">
<link rel="stylesheet" type="text/css" href="css/theme-green.css">
<link rel="stylesheet" type="text/css" href="css/pmd-customstyles.css">

<link rel="shortcut icon" href="images/logo/favicon.ico" type="image/x-icon">
<link rel="icon" href="images/logo/favicon.ico" type="image/x-icon">

<link rel="alternate" type="application/rss+xml" title="" href="feed.xml">

</head>
<body>
<!-- Content is offset by the height of the topnav bar. -->
<!-- There's already a padding-top rule in modern-business.css, but it apparently doesn't work on Firefox 60 and Chrome 67 -->
<div id="topbar-content-offset">
<!-- Navigation -->
<nav class="navbar navbar-expand-lg fixed-top navbar-dark">
    <div class="container topnavlinks">
        <a class="navbar-brand fas fa-home fa-lg" href="index.html">&nbsp;<span class="projectTitle"> PMD Source Code Analyzer Project</span></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0"></ul>
            <ul class="navbar-nav">
                <!-- toggle sidebar button -->
                <li class="nav-item"><a id="tg-sb-link" class="nav-link" href="#"><i id="tg-sb-icon" class="fas fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->
                
                    
                        
                            <li class="nav-item"><a class="nav-link" href="https://github.com/pmd/pmd/releases/latest" target="_blank">Download</a></li>
                        
                    
                        
                            <li class="nav-item"><a class="nav-link" href="https://github.com/pmd/pmd" target="_blank">Fork us on github</a></li>
                        
                    
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
            </ul>
            <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="🔍️ Type 's' to search..." id="search-input" autocomplete="off">
                <ul id="results-container"></ul>
            </form>
        </div>
    </div>
</nav>

<!-- Page Content -->
<div class="container-toc-wrapper">
    <div class="container">
        <div class="col-lg-12">&nbsp;</div>
        <!-- Content Row -->
        <div class="row">
            
            
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                








<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">PMD 7.18.0-SNAPSHOT</li>
    <div class="sidebarTitleDate">Release date: 31-October-2025</div>
    
    
    
        
    
    <li>
        
        <a href="#">About</a>
        
        <ul>
            
            

            

                
                <li><a href="index.html">Home</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_release_notes.html">Release notes</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_release_notes_pmd7.html">Release notes (PMD 7)</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_about_help.html">Getting help</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_about_release_policies.html">Release policies</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_about_support_lifecycle.html">Support lifecycle</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_about_security.html">Security</a></li>
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">User Documentation</a>
        
        <ul>
            
            

            

                
                <li><a href="pmd_userdocs_migrating_to_pmd7.html">Migration Guide for PMD 7</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_installation.html">Installation and basic CLI usage</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_making_rulesets.html">Making rulesets</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_configuring_rules.html">Configuring rules</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_best_practices.html">Best practices</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_suppressing_warnings.html">Suppressing warnings</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_incremental_analysis.html">Incremental analysis</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_cli_reference.html">PMD CLI reference</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_report_formats.html">PMD Report formats</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_3rdpartyrulesets.html">3rd party rulesets</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_userdocs_signed_releases.html">Signed Releases</a></li>
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">CPD reference</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_userdocs_cpd.html">Copy-paste detection</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_cpd_report_formats.html">CPD Report formats</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Extending PMD</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_writing_rules_intro.html">Introduction to writing rules</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_your_first_rule.html">Your first rule</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_writing_xpath_rules.html">XPath rules</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_writing_java_rules.html">Java rules</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_designer_reference.html">Rule designer reference</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_defining_properties.html">Defining rule properties</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_rule_guidelines.html">Rule guidelines</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_testing.html">Testing your rules</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_extending_ast_dump.html">Creating (XML) dump of the AST</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Tools / Integrations</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_maven.html">Maven PMD Plugin</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_gradle.html">Gradle</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_ant.html">Ant</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_java_api.html">PMD Java API</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_bld.html">bld PMD Extension</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_ci.html">CI integrations</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools_ide_plugins.html">IDE Plugins</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_userdocs_tools.html">Other Tools / Integrations</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Rule Reference</a>
        
        <ul>
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Apex Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_apex.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_documentation.html">Documentation</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li class="active"><a href="pmd_rules_apex_performance.html">Performance</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_apex_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">HTML Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_html.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_html_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Java Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_java.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_documentation.html">Documentation</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_multithreading.html">Multithreading</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_performance.html">Performance</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_java_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Java Server Pages Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_jsp.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_jsp_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">JavaScript Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_errorprone.html">Error Prone</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_ecmascript_performance.html">Performance</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Kotlin Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_kotlin.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_kotlin_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_kotlin_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Maven POM Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_pom.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_pom_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Modelica Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_modelica.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_modelica_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">PLSQL Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_plsql.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_plsql_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Salesforce Visualforce Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_visualforce.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_visualforce_security.html">Security</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Scala Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_scala.html">Index</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Swift Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_swift.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_swift_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_swift_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Velocity Template Language (VTL) Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_velocity.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_velocity_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_velocity_design.html">Design</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_velocity_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">WSDL Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_wsdl.html">Index</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">XML Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_xml.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xml_bestpractices.html">Best Practices</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xml_errorprone.html">Error Prone</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">XSL Rules</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_rules_xsl.html">Index</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xsl_codestyle.html">Code Style</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_rules_xsl_performance.html">Performance</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Language-Specific Documentation</a>
        
        <ul>
            
            

            

                
                <li><a href="pmd_languages_index.html">Overview</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_configuration.html">Language configuration</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_apex.html">Apex</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_cpp.html">C/C++</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_cs.html">C#</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_css.html">CSS</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_coco.html">Coco</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_dart.html">Dart</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_fortran.html">Fortran</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_gherkin.html">Gherkin</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_go.html">Go</a></li>
                

            

            
            
            
            
            

            

                
                <li><a href="pmd_languages_html.html">HTML</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_java.html">Java</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_js_ts.html">JavaScript / TypeScript</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_jsp.html">JSP</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_julia.html">Julia</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_kotlin.html">Kotlin</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_lua.html">Lua</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_matlab.html">Matlab</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_modelica.html">Modelica</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_objectivec.html">Objective-C</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_perl.html">Perl</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_php.html">PHP</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_plsql.html">PLSQL</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_python.html">Python</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_ruby.html">Ruby</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_rust.html">Rust</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_scala.html">Scala</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_swift.html">Swift</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_tsql.html">T-SQL</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_visualforce.html">Visualforce</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_velocity.html">Velocity Template Language (VTL)</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_languages_xml.html">XML and XML dialects</a></li>
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Developer Documentation</a>
        
        <ul>
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Contributing</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_devdocs_contributing.html">Contributing</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_development.html">Developer resources</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_contributing_newcomers_guide.html">Newcomers' Guide</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_writing_documentation.html">Writing documentation</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Building PMD</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_devdocs_building_general.html">General Info</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_building.html">Building PMD from source</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_building_intellij.html">Building PMD with IntelliJ IDEA</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_building_eclipse.html">Building PMD with Eclipse IDE</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_building_vscode.html">Building PMD with VS Code IDE</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_building_netbeans.html">Building PMD with Netbeans IDE</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_roadmap.html">Roadmap</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_github_actions_workflows.html">GitHub Actions Workflows</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_how_pmd_works.html">How PMD works</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_logging.html">Logging</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_pmdtester.html">Pmdtester</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_devdocs_rule_deprecation_policy.html">Rule Deprecation Policy</a></li>
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Major contributions</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_devdocs_major_rule_guidelines.html">Rule Guidelines</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_major_adding_dialect.html">Adding a new dialect</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_major_adding_new_language_javacc.html">Adding a new language (JavaCC)</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_major_adding_new_language_antlr.html">Adding a new language (ANTLR)</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_devdocs_major_adding_new_cpd_language.html">Adding a new CPD language</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                
                
                <li class="subfolders">
                    <a href="#">Experimental features</a>
                    <ul>
                        
                        
                        
                        <li><a href="tag_experimental.html">List of experimental Features</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
        </ul>
     </li>
       
        
    
    <li>
        
        <a href="#">Project documentation</a>
        
        <ul>
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Trivia about PMD</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_projectdocs_trivia_news.html">PMD in the press</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_projectdocs_trivia_products.html">Products & books related to PMD</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_projectdocs_trivia_similarprojects.html">Similar projects</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_projectdocs_trivia_meaning.html">What does 'PMD' mean?</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
            

            

                
                <li><a href="pmd_projectdocs_logo.html">Logo</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_projectdocs_faq.html">FAQ</a></li>
                

            

            
            
            

            

                
                <li><a href="license.html">License</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_projectdocs_credits.html">Credits</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_release_notes_old.html">Old release notes</a></li>
                

            

            
            
            

            

                
                <li><a href="pmd_projectdocs_decisions.html">Decisions</a></li>
                

            

            
            
            

            

                
                
                <li class="subfolders">
                    <a href="#">Project management</a>
                    <ul>
                        
                        
                        
                        <li><a href="pmd_projectdocs_committers_infrastructure.html">Infrastructure</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_projectdocs_committers_releasing.html">Release process</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_projectdocs_committers_merging_pull_requests.html">Merging pull requests</a></li>
                        
                        
                        
                        
                        
                        <li><a href="pmd_projectdocs_committers_main_landing_page.html">Main Landing page</a></li>
                        
                        
                        
                    </ul>
                </li>
                
                

            

            
            
        </ul>
     </li>
       
        
        
</ul>

            </div>
            
            

            <!-- Content Column -->
            <div class="col-md-9" id="tg-sb-content">
                <header>
    <div class="row">
        <div class="col-lg-12">
            <a href="./" role="button"
                ><i class="fa fa-home fa-lg"></i
            ></a>
            » Performance   
            <a
                target="_blank"
                href="https://github.com/pmd/pmd/blob/main/docs/../pmd-apex/src/main/resources/category/apex/performance.xml"
                class="float-right"
                role="button"
                ><i class="fab fa-github fa-lg"></i> Edit on GitHub</a
            >
             
        </div>
    </div>

    <hr />
</header>


<div class="post-header">
   <h1 class="post-title-main">Performance</h1>
</div>

<div class="post-content" data-github-edit-url="https://github.com/pmd/pmd/blob/main/docs/../pmd-apex/src/main/resources/category/apex/performance.xml">

   
    <div class="summary">Rules that flag suboptimal code.</div>
   
    <details id="inline-toc-details">
        <summary>Table of Contents</summary>
        <div id="inline-toc"><!-- empty, move TOC here when screen size too small --></div>
    </details>

  <!-- DO NOT EDIT THIS FILE. This file is generated from file ../pmd-apex/src/main/resources/category/apex/performance.xml. -->
<h2 id="avoiddebugstatements">AvoidDebugStatements</h2>

<p><strong>Since:</strong> PMD 6.36.0</p>

<p><strong>Priority:</strong> Medium (3)</p>

<p>Debug statements contribute to longer transactions and consume Apex CPU time even when debug logs are not being captured.</p>

<p>When possible make use of other debugging techniques such as the Apex Replay Debugger and Checkpoints that could cover <em>most</em> use cases.</p>

<p>For other valid use cases that the statement is in fact valid make use of the <code class="language-plaintext highlighter-rouge">@SuppressWarnings</code> annotation or the <code class="language-plaintext highlighter-rouge">//NOPMD</code> comment.</p>

<p><strong>This rule is defined by the following XPath expression:</strong></p>
<div class="language-xpath highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">//</span><span class="nt">MethodCallExpression</span><span class="p">[</span><span class="nf">lower-case</span><span class="p">(</span><span class="na">@FullMethodName</span><span class="p">)</span><span class="err">=</span><span class="s1">'system.debug'</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p><strong>Example(s):</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">bar</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Account</span> <span class="n">acc</span> <span class="o">=</span> <span class="o">[</span><span class="no">SELECT</span> <span class="nc">Name</span><span class="o">,</span> <span class="nc">Owner</span><span class="o">.</span><span class="na">Name</span> <span class="no">FROM</span> <span class="nc">Account</span> <span class="no">LIMIT</span> <span class="mi">1</span><span class="o">];</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="n">accs</span><span class="o">);</span> <span class="c1">// will get reported</span>
    <span class="o">}</span>

    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="err">'</span><span class="no">PMD</span><span class="o">.</span><span class="na">AvoidDebugStatements</span><span class="err">'</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">baz</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Account</span> <span class="n">myAccount</span> <span class="o">=</span> <span class="n">bar</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="nc">LoggingLevel</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span> <span class="c1">// good to go</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Use this rule by referencing it:</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;rule</span> <span class="na">ref=</span><span class="s">"category/apex/performance.xml/AvoidDebugStatements"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="avoidnonrestrictivequeries">AvoidNonRestrictiveQueries</h2>

<p><strong>Since:</strong> PMD 7.4.0</p>

<p><strong>Priority:</strong> Medium (3)</p>

<p>When working with very large amounts of data, unfiltered SOQL or SOSL queries can quickly cause
<a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_gov_limits.htm">governor limit</a>
exceptions.</p>

<p><strong>This rule is defined by the following Java class:</strong> <a href="https://github.com/pmd/pmd/blob/main/pmd-apex/src/main/java/net/sourceforge/pmd/lang/apex/rule/performance/AvoidNonRestrictiveQueriesRule.java">net.sourceforge.pmd.lang.apex.rule.performance.AvoidNonRestrictiveQueriesRule</a></p>

<p><strong>Example(s):</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Something</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">as</span> <span class="o">)</span> <span class="o">{</span>
        <span class="nc">Account</span><span class="o">[]</span> <span class="n">accs1</span> <span class="o">=</span> <span class="o">[</span> <span class="n">select</span> <span class="n">id</span> <span class="n">from</span> <span class="n">account</span> <span class="o">];</span>  <span class="c1">// Bad</span>
        <span class="nc">Account</span><span class="o">[]</span> <span class="n">accs2</span> <span class="o">=</span> <span class="o">[</span> <span class="n">select</span> <span class="n">id</span> <span class="n">from</span> <span class="n">account</span> <span class="n">limit</span> <span class="mi">10</span> <span class="o">];</span>  <span class="c1">// better</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">SObject</span><span class="o">&gt;&gt;</span> <span class="n">searchList</span> <span class="o">=</span> <span class="o">[</span><span class="no">FIND</span> <span class="err">'</span><span class="n">map</span><span class="o">*</span><span class="err">'</span> <span class="no">IN</span> <span class="no">ALL</span> <span class="no">FIELDS</span> <span class="no">RETURNING</span> <span class="nf">Account</span> <span class="o">(</span><span class="nc">Id</span><span class="o">,</span> <span class="nc">Name</span><span class="o">),</span> <span class="nc">Contact</span><span class="o">,</span> <span class="nc">Opportunity</span><span class="o">,</span> <span class="nc">Lead</span><span class="o">];</span> <span class="c1">// bad</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Use this rule by referencing it:</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;rule</span> <span class="na">ref=</span><span class="s">"category/apex/performance.xml/AvoidNonRestrictiveQueries"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="eagerlyloadeddescribesobjectresult">EagerlyLoadedDescribeSObjectResult</h2>

<p><strong>Since:</strong> PMD 6.40.0</p>

<p><strong>Priority:</strong> Medium (3)</p>

<p>This rule finds <code class="language-plaintext highlighter-rouge">DescribeSObjectResult</code>s which could have been loaded eagerly via <code class="language-plaintext highlighter-rouge">SObjectType.getDescribe()</code>.</p>

<p>When using <code class="language-plaintext highlighter-rouge">SObjectType.getDescribe()</code> or <code class="language-plaintext highlighter-rouge">Schema.describeSObjects()</code> without supplying a <code class="language-plaintext highlighter-rouge">SObjectDescribeOptions</code>,
implicitly it will be using <code class="language-plaintext highlighter-rouge">SObjectDescribeOptions.DEFAULT</code> and then all
child relationships will be loaded eagerly regardless whether this information is needed or not.
This has a potential negative performance impact. Instead <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_class_Schema_SObjectType.htm#unique_346834793"><code class="language-plaintext highlighter-rouge">SObjectType.getDescribe(options)</code></a>
or <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_schema.htm#apex_System_Schema_describeSObjects"><code class="language-plaintext highlighter-rouge">Schema.describeSObjects(SObjectTypes, options)</code></a>
should be used and a <code class="language-plaintext highlighter-rouge">SObjectDescribeOptions</code> should be supplied. By using
<code class="language-plaintext highlighter-rouge">SObjectDescribeOptions.DEFERRED</code> the describe attributes will be lazily initialized at first use.</p>

<p>Lazy loading <code class="language-plaintext highlighter-rouge">DescribeSObjectResult</code> on picklist fields is not always recommended. The lazy loaded
describe objects might not be 100% accurate. It might be safer to explicitly use
<code class="language-plaintext highlighter-rouge">SObjectDescribeOptions.FULL</code> in such a case. The same applies when you need the same <code class="language-plaintext highlighter-rouge">DescribeSObjectResult</code>
to be consistent across different contexts and API versions.</p>

<p>Properties:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">noDefault</code>: The behavior of <code class="language-plaintext highlighter-rouge">SObjectDescribeOptions.DEFAULT</code> changes from API Version 43 to 44:
  With API Version 43, the attributes are loaded eagerly. With API Version 44, they are loaded lazily.
  Simply using <code class="language-plaintext highlighter-rouge">SObjectDescribeOptions.DEFAULT</code> doesn’t automatically make use of lazy loading.
  (unless “Use Improved Schema Caching” critical update is applied, <code class="language-plaintext highlighter-rouge">SObjectDescribeOptions.DEFAULT</code> does fallback
  to lazy loading)
  With this property enabled, such usages are found.
  You might ignore this, if you can make sure, that you don’t run a mix of API Versions.</li>
</ul>

<p><strong>This rule is defined by the following XPath expression:</strong></p>
<div class="language-xpath highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">//</span><span class="nt">MethodCallExpression</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="nf">lower-case</span><span class="p">(</span><span class="na">@MethodName</span><span class="p">)</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"getdescribe"</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nt">ReferenceExpression</span><span class="p">[</span><span class="na">@SObjectType</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nf">true</span><span class="p">()]</span><span class="w">
        </span><span class="ow">or</span><span class="w"> </span><span class="nf">lower-case</span><span class="p">(</span><span class="na">@MethodName</span><span class="p">)</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"describesobjects"</span><span class="w">
    </span><span class="p">]</span><span class="w">
    </span><span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="nt">VariableExpression</span><span class="o">/</span><span class="nt">ReferenceExpression</span><span class="w">
            </span><span class="p">[</span><span class="nf">lower-case</span><span class="p">(</span><span class="na">@Image</span><span class="p">)</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">(</span><span class="s2">"sobjectdescribeoptions"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fielddescribeoptions"</span><span class="p">)]</span><span class="w">
         </span><span class="p">)</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">|</span><span class="w">
</span><span class="o">//</span><span class="nt">ReferenceExpression</span><span class="w">
    </span><span class="p">[</span><span class="nv">$noDefault</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="nf">true</span><span class="p">()]</span><span class="w">
    </span><span class="p">[</span><span class="nf">lower-case</span><span class="p">(</span><span class="na">@Image</span><span class="p">)</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"sobjectdescribeoptions"</span><span class="p">]</span><span class="w">
    </span><span class="p">[</span><span class="kn">parent::</span><span class="nt">VariableExpression</span><span class="p">[</span><span class="nf">lower-case</span><span class="p">(</span><span class="na">@Image</span><span class="p">)</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"default"</span><span class="p">]]</span><span class="w">
</span></code></pre></div></div>

<p><strong>Example(s):</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">bar</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">&gt;</span> <span class="n">accounts</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">Account</span><span class="o">.</span><span class="na">SObjectType</span><span class="o">.</span><span class="na">getDescribe</span><span class="o">(</span><span class="nc">SObjectDescribeOptions</span><span class="o">.</span><span class="na">DEFERRED</span><span class="o">).</span><span class="na">isCreateable</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">insert</span> <span class="n">accounts</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>This rule has the following properties:</strong></p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Default Value</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>noDefault</td>
      <td>false</td>
      <td>Do not allow SObjectDescribeOptions.DEFAULT option to ensure consistent results no matter where getDescribe is called</td>
    </tr>
  </tbody>
</table>

<p><strong>Use this rule with the default properties by just referencing it:</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;rule</span> <span class="na">ref=</span><span class="s">"category/apex/performance.xml/EagerlyLoadedDescribeSObjectResult"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p><strong>Use this rule and customize it:</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;rule</span> <span class="na">ref=</span><span class="s">"category/apex/performance.xml/EagerlyLoadedDescribeSObjectResult"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"noDefault"</span> <span class="na">value=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</code></pre></div></div>

<h2 id="operationwithhighcostinloop">OperationWithHighCostInLoop</h2>

<p><strong>Since:</strong> PMD 7.0.0</p>

<p><strong>Priority:</strong> Medium (3)</p>

<p>This rule finds method calls inside loops that are known to be likely a performance issue. These methods should be
called only once before the loop.</p>

<p>Schema class methods like <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_schema.htm#apex_System_Schema_getGlobalDescribe">Schema.getGlobalDescribe()</a>
and <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_schema.htm#apex_System_Schema_describeSObjects">Schema.describeSObjects()</a>
might be slow depending on the size of your organization. Calling these methods repeatedly inside a loop creates
a potential performance issue.</p>

<p><strong>This rule is defined by the following Java class:</strong> <a href="https://github.com/pmd/pmd/blob/main/pmd-apex/src/main/java/net/sourceforge/pmd/lang/apex/rule/performance/OperationWithHighCostInLoopRule.java">net.sourceforge.pmd.lang.apex.rule.performance.OperationWithHighCostInLoopRule</a></p>

<p><strong>Example(s):</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalDescribeExample</span> <span class="o">{</span>
    <span class="c1">// incorrect example</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getGlobalDescribeInLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fieldNameSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span><span class="err">'</span><span class="nc">Id</span><span class="err">'</span><span class="o">};</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">fieldNameOrDefaultValue</span> <span class="o">:</span> <span class="n">fieldNameOrDefaultValueList</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Schema.getGlobalDescribe() should be called only once before the for-loop</span>
            <span class="k">if</span> <span class="o">(</span><span class="nc">Schema</span><span class="o">.</span><span class="na">getGlobalDescribe</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">objectName</span><span class="o">).</span><span class="na">getDescribe</span><span class="o">().</span><span class="na">fields</span><span class="o">.</span><span class="na">getMap</span><span class="o">().</span><span class="na">containsKey</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">.</span><span class="na">trim</span><span class="o">()))</span> <span class="o">{</span>
                <span class="n">fieldNameSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// corrected example</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getGlobalDescribeInLoopCorrected</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Schema</span><span class="o">.</span><span class="na">SObjectField</span><span class="o">&gt;</span> <span class="n">fieldMap</span> <span class="o">=</span> <span class="nc">Schema</span><span class="o">.</span><span class="na">getGlobalDescribe</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">objectName</span><span class="o">).</span><span class="na">getDescribe</span><span class="o">().</span><span class="na">fields</span><span class="o">.</span><span class="na">getMap</span><span class="o">();</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fieldNameSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span><span class="err">'</span><span class="nc">Id</span><span class="err">'</span><span class="o">};</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">fieldNameOrDefaultValue</span> <span class="o">:</span> <span class="n">fieldNameOrDefaultValueList</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">fieldMap</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">.</span><span class="na">trim</span><span class="o">()))</span> <span class="o">{</span>
                <span class="n">fieldNameSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DescribeSObjectsExample</span> <span class="o">{</span>
    <span class="c1">// incorrect example</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">describeSObjectsInLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fieldNameSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span><span class="err">'</span><span class="nc">Id</span><span class="err">'</span><span class="o">};</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">fieldNameOrDefaultValue</span> <span class="o">:</span> <span class="n">fieldNameOrDefaultValueList</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Schema</span><span class="o">.</span><span class="na">DescribeSObjectResult</span> <span class="n">dsr</span> <span class="o">=</span> <span class="nc">Account</span><span class="o">.</span><span class="na">sObjectType</span><span class="o">.</span><span class="na">getDescribe</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="nc">Schema</span><span class="o">.</span><span class="na">describeSObjects</span><span class="o">(</span><span class="k">new</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span> <span class="n">sObjectType</span> <span class="o">})[</span><span class="mi">0</span><span class="o">].</span><span class="na">fields</span><span class="o">.</span><span class="na">getMap</span><span class="o">().</span><span class="na">containsKey</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">.</span><span class="na">trim</span><span class="o">()))</span> <span class="o">{</span>
                <span class="n">fieldNameSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// corrected example</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">describeSObjectsInLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Schema</span><span class="o">.</span><span class="na">SObjectField</span><span class="o">&gt;</span> <span class="n">fieldMap</span> <span class="o">=</span> <span class="nc">Schema</span><span class="o">.</span><span class="na">describeSObjects</span><span class="o">(</span><span class="k">new</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span> <span class="err">'</span><span class="nc">Account</span><span class="err">'</span> <span class="o">})[</span><span class="mi">0</span><span class="o">].</span><span class="na">fields</span><span class="o">.</span><span class="na">getMap</span><span class="o">();</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fieldNameSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span><span class="err">'</span><span class="nc">Id</span><span class="err">'</span><span class="o">};</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">fieldNameOrDefaultValue</span> <span class="o">:</span> <span class="n">fieldNameOrDefaultValueList</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">fieldMap</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">.</span><span class="na">trim</span><span class="o">()))</span> <span class="o">{</span>
                <span class="n">fieldNameSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fieldNameOrDefaultValue</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Use this rule by referencing it:</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;rule</span> <span class="na">ref=</span><span class="s">"category/apex/performance.xml/OperationWithHighCostInLoop"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="operationwithlimitsinloop">OperationWithLimitsInLoop</h2>

<p><strong>Since:</strong> PMD 6.29.0</p>

<p><strong>Priority:</strong> Medium (3)</p>

<p>Database class methods, DML operations, SOQL queries, SOSL queries, Approval class methods, Email sending, async scheduling or queueing within loops can cause governor limit exceptions. Instead, try to batch up the data into a list and invoke the operation once on that list of data outside the loop.</p>

<p><strong>This rule is defined by the following Java class:</strong> <a href="https://github.com/pmd/pmd/blob/main/pmd-apex/src/main/java/net/sourceforge/pmd/lang/apex/rule/performance/OperationWithLimitsInLoopRule.java">net.sourceforge.pmd.lang.apex.rule.performance.OperationWithLimitsInLoopRule</a></p>

<p><strong>Example(s):</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Something</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">databaseMethodInsideOfLoop</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">&gt;</span> <span class="n">accounts</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Account</span> <span class="n">a</span> <span class="o">:</span> <span class="n">accounts</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Database</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dmlInsideOfLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">151</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Account</span> <span class="n">account</span><span class="o">;</span>
            <span class="c1">// ...</span>
            <span class="n">insert</span> <span class="n">account</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">soqlInsideOfLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">&gt;</span> <span class="n">accounts</span> <span class="o">=</span> <span class="o">[</span><span class="no">SELECT</span> <span class="nc">Id</span> <span class="no">FROM</span> <span class="nc">Account</span><span class="o">];</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">soslInsideOfLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">SObject</span><span class="o">&gt;&gt;</span> <span class="n">searchList</span> <span class="o">=</span> <span class="o">[</span><span class="no">FIND</span> <span class="err">'</span><span class="n">map</span><span class="o">*</span><span class="err">'</span> <span class="no">IN</span> <span class="no">ALL</span> <span class="no">FIELDS</span> <span class="no">RETURNING</span> <span class="nf">Account</span> <span class="o">(</span><span class="nc">Id</span><span class="o">,</span> <span class="nc">Name</span><span class="o">),</span> <span class="nc">Contact</span><span class="o">,</span> <span class="nc">Opportunity</span><span class="o">,</span> <span class="nc">Lead</span><span class="o">];</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">messageInsideOfLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Messaging</span><span class="o">.</span><span class="na">SingleEmailMessage</span> <span class="n">email</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Messaging</span><span class="o">.</span><span class="na">SingleEmailMessage</span><span class="o">();</span>
            <span class="nc">Messaging</span><span class="o">.</span><span class="na">sendEmail</span><span class="o">(</span><span class="k">new</span> <span class="nc">Messaging</span><span class="o">.</span><span class="na">SingleEmailMessage</span><span class="o">[]{</span><span class="n">email</span><span class="o">});</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">approvalInsideOfLoop</span><span class="o">(</span><span class="nc">Account</span><span class="o">[]</span> <span class="n">accs</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Account</span> <span class="n">acc</span> <span class="o">=</span> <span class="n">accs</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="nc">Approval</span><span class="o">.</span><span class="na">ProcessSubmitRequest</span> <span class="n">req</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Approval</span><span class="o">.</span><span class="na">ProcessSubmitRequest</span><span class="o">();</span>
            <span class="n">req</span><span class="o">.</span><span class="na">setObjectId</span><span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">Id</span><span class="o">);</span>
            <span class="nc">Approval</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>
            <span class="nc">Approval</span><span class="o">.</span><span class="na">lock</span><span class="o">(</span><span class="n">acc</span><span class="o">);</span>
            <span class="nc">Approval</span><span class="o">.</span><span class="na">unlock</span><span class="o">(</span><span class="n">acc</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">asyncInsideOfLoop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Integer</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">enqueueJob</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyQueueable</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">schedule</span><span class="o">(</span><span class="sc">'x'</span><span class="o">,</span> <span class="err">'</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">?</span><span class="err">'</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MySchedule</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">scheduleBatch</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyBatch</span><span class="o">(),</span> <span class="sc">'x'</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Use this rule by referencing it:</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;rule</span> <span class="na">ref=</span><span class="s">"category/apex/performance.xml/OperationWithLimitsInLoop"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>



    <div class="tags">
        
    </div>

</div>


<footer>
    
    <hr />
    <div>
        This documentation is written in markdown. <br />
        If there is something missing or can be improved, edit this page on
        github and create a PR:
        <a
            target="_blank"
            href="https://github.com/pmd/pmd/blob/main/docs/../pmd-apex/src/main/resources/category/apex/performance.xml"
            role="button"
            ><i class="fab fa-github fa-lg"></i> Edit on GitHub</a
        >
    </div>
    
    <hr />
    <div class="row">
        <div class="col-lg-12 footer">
            &copy;2025 PMD Open Source Project. All rights
            reserved. <br />
             Site last generated: Oct 24, 2025 <br />
            <p>
                <img src="images/logo/pmd-logo-70px.png" alt="PMD
                logo"/>
            </p>
        </div>
    </div>
</footer>


            </div>

            <!-- /.row -->
        </div>
        <!-- /.container -->
    </div>

    
    <!-- Sticky TOC column -->
    <div class="toc-col">
        <div id="toc"></div>
    </div>
    
    <!-- /.toc-container-wrapper -->
</div>
</div>

<script type="application/javascript" src="assets/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script type="application/javascript" src="assets/anchorjs-4.2.2/anchor.min.js"></script>
<script type="application/javascript" src="assets/navgoco-0.2.1/src/jquery.navgoco.min.js"></script>
<script type="application/javascript" src="assets/bootstrap-4.5.2-dist/js/bootstrap.bundle.min.js"></script>
<script type="application/javascript" src="assets/Simple-Jekyll-Search-1.14.0/dest/simple-jekyll-search.min.js"></script>
<script type="application/javascript" src="assets/jekyll-table-of-contents/toc.js"></script>
<script type="application/javascript" src="js/tabstate.js"></script>
<script type="application/javascript" src="js/customscripts.js"></script>
<script type="application/javascript" src="js/search.js"></script>



</body>
</html>
